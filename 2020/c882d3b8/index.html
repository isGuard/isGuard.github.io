<!DOCTYPE html><html lang=zh-CN><head><meta charset=UTF-8><meta name=viewport content="width=device-width, initial-scale=1, maximum-scale=2"><meta name=theme-color content=#222><meta name=generator content="Hexo 4.2.0"><link rel=apple-touch-icon sizes=180x180 href=/images/guard.png><link rel=icon type=image/png sizes=32x32 href=/images/guard.png><link rel=icon type=image/png sizes=16x16 href=/images/guard.png><link rel=mask-icon href=/images/guard.svg color=#222><meta name=google-site-verification content=1zwyY4tiPsHyxK1HeGG9l5f7srBaAW3y7T6oyfo-7Vk><meta name=msvalidate.01 content=E4B8BD2F04290DD88CD9F8BF5853705F><meta name=baidu-site-verification content=H0FI8ImJtX><link rel=stylesheet href=/css/main.css><link rel=stylesheet href=//cdn.bootcss.com/font-awesome/4.6.2/css/font-awesome.min.css><link rel=stylesheet href=//cdn.jsdelivr.net/npm/pace-js@1/themes/blue/pace-theme-minimal.css><script src=//cdn.jsdelivr.net/npm/pace-js@1/pace.min.js></script><script id=hexo-configurations>
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"blog.guard.ren","root":"/","scheme":"Mist","version":"7.7.2","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12,"onmobile":true},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":true,"lazyload":true,"pangu":true,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":true,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script><meta name=description content="什么是注解 * Annotation 是从 JDK5.0 开始引入的新技术 * Annotation 的作用： * 不是程序本身，可以对程序作出解释。（这一点个注释（comment）没什么区别） * 可以被其他程序（比如：编译器等）读取。 * Annotation 的格式： * 注解是以”@注释名”在代码中存在的，还可以添加一些参数值，例如：@SuppressWarn"><meta property=og:type content=article><meta property=og:title content=Java注解和反射><meta property=og:url content=https://blog.guard.ren/2020/c882d3b8/index.html><meta property=og:site_name content=何年何月何时多><meta property=og:description content="什么是注解 * Annotation 是从 JDK5.0 开始引入的新技术 * Annotation 的作用： * 不是程序本身，可以对程序作出解释。（这一点个注释（comment）没什么区别） * 可以被其他程序（比如：编译器等）读取。 * Annotation 的格式： * 注解是以”@注释名”在代码中存在的，还可以添加一些参数值，例如：@SuppressWarn"><meta property=og:locale content=zh_CN><meta property=og:image content="https://cdn.nlark.com/yuque/0/2020/png/241578/1584343007590-782ea2fa-9eb4-48bd-aa14-c0f91fdb4bff.png#align=left&display=inline&height=288&name=image.png&originHeight=288&originWidth=1184&size=208190&status=done&style=none&width=1184"><meta property=og:image content="https://cdn.nlark.com/yuque/0/2020/png/241578/1584343871382-3d5ebae0-78d0-4413-a7a0-84829e9f5740.png#align=left&display=inline&height=525&name=image.png&originHeight=525&originWidth=654&size=259399&status=done&style=none&width=654"><meta property=og:image content=https://cdn.nlark.com/yuque/0/2020/svg/241578/1584421598454-62a1ca39-0658-4273-8b5a-a2f5f1cbebe5.svg><meta property=og:image content="https://cdn.nlark.com/yuque/0/2020/png/241578/1584421646211-dfca5653-f62f-4af1-9fae-aa3a80e6f982.png#align=left&display=inline&height=322&name=image.png&originHeight=322&originWidth=752&size=197916&status=done&style=none&width=752"><meta property=og:image content="https://cdn.nlark.com/yuque/0/2020/jpeg/241578/1584424373550-ba66b4b3-bb74-41bd-a9c3-ecaa89fc17e5.jpeg#align=left&display=inline&height=277&originHeight=277&originWidth=600&size=0&status=done&style=none&width=600"><meta property=og:image content="https://cdn.nlark.com/yuque/0/2020/jpeg/241578/1584424597049-d22e1fb1-600a-459e-a701-7c8139897dea.jpeg#align=left&display=inline&height=441&originHeight=441&originWidth=690&size=0&status=done&style=none&width=690"><meta property=og:image content="https://cdn.nlark.com/yuque/0/2020/png/241578/1584590106574-28cfb7b6-f8a6-4b51-9abe-d7c33e101311.png#align=left&display=inline&height=330&name=image.png&originHeight=330&originWidth=1309&size=253830&status=done&style=none&width=1309"><meta property=article:published_time content=2020-03-16T06:08:14.000Z><meta property=article:modified_time content=2020-09-02T10:32:00.500Z><meta property=article:author content=何年何月何时多><meta property=article:tag content=我的身旁是一扇亮了又暗的窗><meta name=twitter:card content=summary><meta name=twitter:image content="https://cdn.nlark.com/yuque/0/2020/png/241578/1584343007590-782ea2fa-9eb4-48bd-aa14-c0f91fdb4bff.png#align=left&display=inline&height=288&name=image.png&originHeight=288&originWidth=1184&size=208190&status=done&style=none&width=1184"><link rel=canonical href="https://blog.guard.ren/2020/c882d3b8/"><script id=page-configurations>
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true
  };
</script><meta name=referrer content=no-referrer><title>Java注解和反射 | 何年何月何时多</title><script>
      function sendPageView() {
        if (CONFIG.hostname !== location.hostname) return;
        var uid = localStorage.getItem('uid') || (Math.random() + '.' + Math.random());
        localStorage.setItem('uid', uid);
        navigator.sendBeacon('https://www.google-analytics.com/collect', new URLSearchParams({
          v  : 1,
          tid: 'UA-136832726-1',
          cid: uid,
          t  : 'pageview',
          dp : encodeURIComponent(location.pathname)
        }));
      }
      document.addEventListener('pjax:complete', sendPageView);
      sendPageView();
    </script><script pjax>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?2d6a21bdd6e9c407e7e8a37193a8230b";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script><noscript><style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style></noscript></head><body itemscope itemtype=http://schema.org/WebPage><div class="container use-motion"><div class=headband></div><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle aria-label=切换导航栏><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div></div><div class=site-meta><div><a href="/" class=brand rel=start><span class=logo-line-before><i></i></span> <span class=site-title>何年何月何时多</span> <span class=logo-line-after><i></i></span></a></div><h1 class=site-subtitle itemprop=description>我的身旁是一扇亮了又暗的窗</h1></div><div class=site-nav-right><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul id=menu class=menu><li class="menu-item menu-item-home"><a href="/" rel=section><i class="fa fa-fw fa-home"></i>首页</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel=section><i class="fa fa-fw fa-archive"></i>归档</a></li><li class="menu-item menu-item-search"><a role=button class=popup-trigger><i class="fa fa-search fa-fw"></i>搜索</a></li></ul></nav><div class=site-search><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon><i class="fa fa-search"></i></span><div class=search-input-container><input autocomplete=off autocorrect=off autocapitalize=off placeholder=搜索... spellcheck=false type=search class=search-input></div><span class=popup-btn-close><i class="fa fa-times-circle"></i></span></div><div id=search-result><div id=no-result><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></div></div></header><div class=back-to-top><i class="fa fa-arrow-up"></i> <span>0%</span></div><div class=reading-progress-bar></div><a href=https://github.com/isGuard class=github-corner title="Follow me on GitHub" aria-label="Follow me on GitHub" rel=noopener target=_blank><svg width=80 height=80 viewbox="0 0 250 250" aria-hidden=true><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill=currentColor style="transform-origin: 130px 106px;" class=octo-arm></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill=currentColor class=octo-body></path></svg></a><main class=main><div class=main-inner><div class=content-wrap><div class=content><div class=posts-expand><article itemscope itemtype=http://schema.org/Article class=post-block lang=zh-CN><link itemprop=mainEntityOfPage href="https://blog.guard.ren/2020/c882d3b8/"><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="https://q1.qlogo.cn/g?b=qq&nk=770600073&s=5"><meta itemprop=name content=何年何月何时多><meta itemprop=description content=我的身旁是一扇亮了又暗的窗></span> <span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content=何年何月何时多></span><header class=post-header><h2 class=post-title itemprop="name headline">Java注解和反射</h2><div class=post-meta><span class=post-meta-item><span class=post-meta-item-icon><i class="fa fa-calendar-o"></i></span> <span class=post-meta-item-text>发表于</span><time title="创建时间：2020-03-16 14:08:14" itemprop="dateCreated datePublished" datetime=2020-03-16T14:08:14+08:00>2020-03-16</time></span> <span class=post-meta-item><span class=post-meta-item-icon><i class="fa fa-calendar-check-o"></i></span> <span class=post-meta-item-text>更新于</span><time title="修改时间：2020-09-02 18:32:00" itemprop=dateModified datetime=2020-09-02T18:32:00+08:00>2020-09-02</time></span> <span id="/2020/c882d3b8/" class="post-meta-item leancloud_visitors" data-flag-title=Java注解和反射 title=阅读次数><span class=post-meta-item-icon><i class="fa fa-eye"></i></span> <span class=post-meta-item-text>阅读次数：</span> <span class=leancloud-visitors-count></span></span> <span class=post-meta-item><span class=post-meta-item-icon><i class="fa fa-comment-o"></i></span> <span class=post-meta-item-text>Valine：</span> <a title=valine href=/2020/c882d3b8/#valine-comments itemprop=discussionUrl><span class="post-comments-count valine-comment-count" data-xid="/2020/c882d3b8/" itemprop=commentCount></span></a></span><br><span class=post-meta-item title=本文字数><span class=post-meta-item-icon><i class="fa fa-file-word-o"></i></span> <span class=post-meta-item-text>本文字数：</span> <span>21k</span></span> <span class=post-meta-item title=阅读时长><span class=post-meta-item-icon><i class="fa fa-clock-o"></i></span> <span class=post-meta-item-text>阅读时长 &asymp;</span> <span>19 分钟</span></span></div></header><div class=post-body itemprop=articleBody><h1 id=什么是注解><a href=#什么是注解 class=headerlink title=什么是注解></a>什么是注解</h1><ul><li>Annotation 是从 JDK5.0 开始引入的新技术</li><li>Annotation 的作用：<ul><li>不是程序本身，可以对程序作出解释。（这一点个注释（comment）没什么区别）</li><li>可以被其他程序（比如：编译器等）读取。</li></ul></li><li>Annotation 的格式：<ul><li>注解是以”@注释名”在代码中存在的，还可以添加一些参数值，例如：@SuppressWarnings（value=”unchecked”）.</li></ul></li><li>Annottation 在哪里使用<ul><li>可以附加在 package、class、methed、field 等上面，相当于给他们添加了额外的辅助信息，我们可以通过<strong>反射机制</strong>编程实现对这些元数据的访问</li></ul></li></ul><hr><h2 id=内置注解><a href=#内置注解 class=headerlink title=内置注解></a>内置注解</h2><ul><li>@Override：定义在 java.lang.Override 中，此注释只适用于修辞方法，表示一个方法声明打算重写超类中的另一个方法声明</li><li>@Deprecated：定义在 java.lang.Deprecated 中，此注释可以用于修辞方法、属性、类，表示不鼓励程序员使用这样的元素，通常是因为它很危险或者存在更好的选择</li><li>@SuppressWarnings：定义在 java.lang.SuppressWarnings 中，用来抑制编译时的警告信息.<ul><li>与前两个注释有所不同，你需要添加一个参数才能正确使用，这些参数都是已经定义好了的，我们选择性的使用就好了</li><li>@SuppressWarnings（”all”）</li><li>@SuppressWarnings（”unchecked”）</li><li>@SuppressWarnings（value-（”unchecked”，”deprecation”）</li><li>等等…</li></ul></li></ul><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br></pre></td><td class=code><pre><span class=line><span class=comment>//内置注解</span></span><br><span class=line><span class=keyword>public</span> <span class=class><span class=keyword>class</span> <span class=title>Test01</span> <span class=keyword>extends</span> <span class=title>Object</span> </span>&#123;</span><br><span class=line></span><br><span class=line>    <span class=comment>//@Override 重写的注解</span></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=function><span class=keyword>public</span> String <span class=title>toString</span><span class=params>()</span> </span>&#123;</span><br><span class=line>        <span class=keyword>return</span> <span class=keyword>super</span>.toString();</span><br><span class=line>    &#125;</span><br><span class=line></span><br><span class=line>    <span class=comment>//@Deprecated 不推荐程序员使用，但是可以使用或者存在更好的方式</span></span><br><span class=line>    <span class=meta>@Deprecated</span></span><br><span class=line>    <span class=function><span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class=title>test01</span><span class=params>()</span> </span>&#123;</span><br><span class=line>        System.out.println(<span class=string>"Deprecated"</span>);</span><br><span class=line>    &#125;</span><br><span class=line></span><br><span class=line>    <span class=function><span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class=title>main</span><span class=params>(String[] args)</span> </span>&#123;</span><br><span class=line>        test01();</span><br><span class=line>    &#125;</span><br><span class=line></span><br><span class=line>    <span class=comment>//SuppressWarnings 用来抑制编译时的警告信息</span></span><br><span class=line>    <span class=meta>@SuppressWarnings</span>(<span class=string>"all"</span>)</span><br><span class=line>    <span class=function><span class=keyword>public</span> <span class=keyword>void</span> <span class=title>test02</span><span class=params>()</span> </span>&#123;</span><br><span class=line>        List list = <span class=keyword>new</span> ArrayList&lt;&gt;();</span><br><span class=line>    &#125;</span><br><span class=line>&#125;</span><br></pre></td></tr></table></figure><hr><h2 id=元注解><a href=#元注解 class=headerlink title=元注解></a>元注解</h2><ul><li>元注解的作用就是负责注解其他注解，Java 定义了 4 个标准的 meta-annotation 类型，他们被用来提供对其他 annotation 类型作说明</li><li>这些类型和它们所支持的类在 java.lang.annotation 包中可以找到（<strong>@Target</strong>，<strong>@Retention，@Documented</strong>，<strong>@Inherited</strong>）<ul><li><strong>@Target</strong>：用于描述注解的使用范围（即：被描述的注解可以用在什么地方）</li><li><strong>@Retention</strong>：表示需要在什么级别保存该注释信息，用于描述注解的生命周期<ul><li>（SOURCE &lt; CLASS &lt; <strong>RUNTIME</strong>）</li></ul></li><li>@Document：说明该注解将被包含在 javadoc 中</li><li>@Inherited：说明子类可以<strong>继承</strong>父类中的该注解</li></ul></li></ul><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br></pre></td><td class=code><pre><span class=line><span class=comment>// 定义一个注解</span></span><br><span class=line><span class=comment>//Target 表示注解可以在那个地方使用</span></span><br><span class=line><span class=meta>@Target</span>(value = &#123;ElementType.METHOD, ElementType.TYPE&#125;)</span><br><span class=line><span class=comment>//Retention 表示注解在什么时候还有效</span></span><br><span class=line><span class=comment>//runtime&gt;class&gt;sources</span></span><br><span class=line><span class=meta>@Retention</span>(value = RetentionPolicy.RUNTIME)</span><br><span class=line><span class=comment>//Documented 表示是否将注解生成在Javadoc中</span></span><br><span class=line><span class=meta>@Documented</span></span><br><span class=line><span class=comment>//Inherited 子类可以继承父类的注解</span></span><br><span class=line><span class=meta>@Inherited</span></span><br><span class=line><span class=meta>@interface</span> MyAnnotation &#123;&#125;</span><br></pre></td></tr></table></figure><hr><h2 id=自定义注解><a href=#自定义注解 class=headerlink title=自定义注解></a>自定义注解</h2><ul><li>使用@interface 自定义注解时，自动继承了 java.lang.annotation.Annotation 接口</li><li>分析：<ul><li>@interface 用来声明一个注解，格式： <code>public @interface 注解名 {定义内容}</code></li><li>其中的每一个方法实际上是声明了一个配置参数</li><li>方法的名称就是参数的名称</li><li>返回值类型就是参数的类型（返回值只能是基本类型，Class，String，enum）</li><li>可以通过 default 来声明参数的默认值</li><li>如果只有一个参数成员，一般参数名为 value</li><li>注解元素必须要有值，我们定义注解元素时，经常使用空字符串，0 作为默认值</li></ul></li></ul><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br></pre></td><td class=code><pre><span class=line><span class=comment>//自定义注解</span></span><br><span class=line><span class=keyword>public</span> <span class=class><span class=keyword>class</span> <span class=title>Test03</span> </span>&#123;</span><br><span class=line></span><br><span class=line>    <span class=comment>//注解可以显示赋值，如果没有默认值，就必须给注解赋值</span></span><br><span class=line>    <span class=meta>@MyAnnotation</span>2(name = <span class=string>"= ="</span>, schools = &#123;<span class=string>"xx"</span>, <span class=string>"yy"</span>&#125;)</span><br><span class=line>    <span class=function><span class=keyword>public</span> <span class=keyword>void</span> <span class=title>test01</span><span class=params>()</span> </span>&#123;</span><br><span class=line>    &#125;</span><br><span class=line>    <span class=comment>//value默认可以省略</span></span><br><span class=line>    <span class=meta>@MyAnnotation</span>3(<span class=string>"xx"</span>)</span><br><span class=line>    <span class=function><span class=keyword>public</span> <span class=keyword>void</span> <span class=title>test02</span><span class=params>()</span> </span>&#123;</span><br><span class=line>    &#125;</span><br><span class=line>&#125;</span><br><span class=line></span><br><span class=line><span class=meta>@Target</span>(&#123;ElementType.TYPE, ElementType.METHOD&#125;)</span><br><span class=line><span class=meta>@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class=line><span class=meta>@interface</span> MyAnnotation2 &#123;</span><br><span class=line>    <span class=comment>//注解的参数：参数类型 + 参数名();</span></span><br><span class=line>    <span class=function>String <span class=title>name</span><span class=params>()</span> <span class=keyword>default</span> ""</span>;</span><br><span class=line></span><br><span class=line>    <span class=function><span class=keyword>int</span> <span class=title>age</span><span class=params>()</span> <span class=keyword>default</span> 0</span>;</span><br><span class=line></span><br><span class=line>    <span class=function><span class=keyword>int</span> <span class=title>id</span><span class=params>()</span> <span class=keyword>default</span> -1</span>;<span class=comment>//如果默认值为-1，代表不存在</span></span><br><span class=line></span><br><span class=line>    String[] schools();</span><br><span class=line>&#125;</span><br><span class=line></span><br><span class=line><span class=meta>@Target</span>(&#123;ElementType.TYPE, ElementType.METHOD&#125;)</span><br><span class=line><span class=meta>@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class=line><span class=meta>@interface</span> MyAnnotation3 &#123;</span><br><span class=line>    <span class=function>String <span class=title>value</span><span class=params>()</span></span>;</span><br><span class=line>&#125;</span><br></pre></td></tr></table></figure><hr><h1 id=反射机制><a href=#反射机制 class=headerlink title=反射机制></a>反射机制</h1><h2 id=Java-反射机制概述><a href=#Java-反射机制概述 class=headerlink title="Java 反射机制概述"></a>Java 反射机制概述</h2><h3 id=静态语言与动态语言><a href=#静态语言与动态语言 class=headerlink title=静态语言与动态语言></a>静态语言与动态语言</h3><h4 id=动态语言><a href=#动态语言 class=headerlink title=动态语言></a>动态语言</h4><ul><li>是一类在运行时可以改变其结构的语言：例如新的函数、对象、甚至代码可以被引进，已有的函数可以被删除或是其他结构上的变化。通俗点说就是在运行时代码可以根据某些条件改变自身结构</li><li>主要动态语言：Object-C、C#、JavaScript、PHP、Python 等</li></ul><figure class="highlight javascript"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br></pre></td><td class=code><pre><span class=line><span class=function><span class=keyword>function</span> <span class=title>f</span>(<span class=params></span>) </span>&#123;</span><br><span class=line>  <span class=keyword>var</span> x = <span class=string>"var a=3;var b=3;alert(a+b)"</span>;</span><br><span class=line>  <span class=built_in>eval</span>(x); <span class=comment>// 6</span></span><br><span class=line>&#125;</span><br></pre></td></tr></table></figure><h4 id=静态语言><a href=#静态语言 class=headerlink title=静态语言></a>静态语言</h4><ul><li>与动态语言相对应的，运行时结构不可变的语言就是静态语言。如 Java、C、C++</li><li>Java 不是动态语言，但 Java 可以称之为“准动态语言”。即 Java 有一定的动态性，我们可以利用反射机制获得类似动态语言的特性。Java 的动态性让编程的时候更加灵活</li></ul><h3 id=Java-Reflection><a href=#Java-Reflection class=headerlink title="Java Reflection"></a>Java Reflection</h3><ul><li>Reflection（反射）是 Java 被视为动态语言的关键，反射机制允许程序在执行期借助于 Reflection API 取得任何类的内部信息，并能直接操作任意对象的内部属性及方法</li></ul><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line>Class c = Class.forName（<span class=string>"java.lang.String"</span>）</span><br></pre></td></tr></table></figure><ul><li>加载完类之后，在堆内存的方法区中就产生了一个 Class 类型的对象（一个类只有一个 Class 对象），这个对象就包含了完整的类的结构信息。我们可以通过这个对象看到类的结构。这个对象就像一面镜子，透过这个镜子看到类的结构，所以，我们形象的称之为：反射</li></ul><p><img data-src="https://cdn.nlark.com/yuque/0/2020/png/241578/1584343007590-782ea2fa-9eb4-48bd-aa14-c0f91fdb4bff.png#align=left&display=inline&height=288&name=image.png&originHeight=288&originWidth=1184&size=208190&status=done&style=none&width=1184" alt=image.png></p><hr><h3 id=Java-反射机制提供的功能><a href=#Java-反射机制提供的功能 class=headerlink title="Java 反射机制提供的功能"></a>Java 反射机制提供的功能</h3><ul><li>在运行时判断任意一个对象所属的类</li><li>在运行时构造任意一个类的对象</li><li>在运行时判断任意一个类所具有的成员变量和方法</li><li>在运行时获取泛型信息</li><li>在运行时调用任意一个对象的成员变量和方法</li><li>在运行时处理注解</li><li>生成动态代理</li><li>……</li></ul><hr><h3 id=Java-反射优点和缺点><a href=#Java-反射优点和缺点 class=headerlink title="Java 反射优点和缺点"></a>Java 反射优点和缺点</h3><h4 id=优点：><a href=#优点： class=headerlink title=优点：></a>优点：</h4><ul><li>可以实现动态创建对象和编译，体现出很大的灵活性</li></ul><h4 id=缺点：><a href=#缺点： class=headerlink title=缺点：></a>缺点：</h4><ul><li>对性能有影响。使用反射基本上是一种解释操作，我们可以告诉 JVM，我们希望做什么并且它满足我们的要求。这类操作总是慢于直接执行相同的操作</li></ul><hr><h3 id=反射相关的主要-API><a href=#反射相关的主要-API class=headerlink title="反射相关的主要 API"></a>反射相关的主要 API</h3><ul><li>java.lang.Class：代表一个类</li><li>java.lang.reflect.Method：代表类的方法</li><li>java.lang.reflect.Field：代表类的成员变量</li><li>java.lang.reflect.Constructor：代表类的构造器</li><li>……</li></ul><hr><h2 id=理解-Class-类并获取-Class><a href=#理解-Class-类并获取-Class class=headerlink title="理解 Class 类并获取 Class"></a>理解 Class 类并获取 Class</h2><h3 id=Class-类><a href=#Class-类 class=headerlink title="Class 类"></a>Class 类</h3><p>在 Object 类中定义了以下的方法，此方法将被所有子类继承</p><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line><span class=function><span class=keyword>public</span> <span class=keyword>final</span> Class <span class=title>getClass</span><span class=params>()</span></span></span><br></pre></td></tr></table></figure><p><img data-src="https://cdn.nlark.com/yuque/0/2020/png/241578/1584343871382-3d5ebae0-78d0-4413-a7a0-84829e9f5740.png#align=left&display=inline&height=525&name=image.png&originHeight=525&originWidth=654&size=259399&status=done&style=none&width=654" alt=image.png></p><ul><li>以上的方法返回值的类型是一个 Class 类，此类是 Java 反射的源头，实际上所调反射从程序的运行结果来看也很好理解，即：可以通过对象反射求出类的名称</li><li>对象照镜子后可以得到的信息：某个类的属性、方法和构造器、某个类到底实现了哪些接口对于每个类而言，JRE 都为其保留一个不变的 Class 类型的对象。一个 Class 对象包含了特定某个结构（class/interface/enum/annotation/primitive type/void/[]）的有关信息<ul><li>Class 本身也是一个类</li><li>Class 对象只能由系统建立对象</li><li>一个加载的类在 JVM 中只会有一个 Class 实例</li><li>一个 Class 对象对应的是一个加载到 JVM 中的一个.class 文件</li><li>每个类的实例都会记得自己是由哪个 Class 实例所生成</li><li>通过 Class 可以完整地得到一个类中的所有被加载的结构</li><li>Class 类是 Reflection 的根源，针对任何你想动态加载、运行的类，唯有先获得相应的 Class 对象</li></ul></li></ul><hr><h3 id=Class-类的常用方法><a href=#Class-类的常用方法 class=headerlink title="Class 类的常用方法"></a>Class 类的常用方法</h3><table><thead><tr><th>方法名</th><th>功能说明</th></tr></thead><tbody><tr><td>static ClassforName(String name)</td><td>返回指定类名 name 的 Class 对象</td></tr><tr><td>Object newInstance()</td><td>调用缺省构造函数，返回 Class 对象的一个实例</td></tr><tr><td>getName()</td><td>返回此 Class 对象所表示的实体（类，接口，数组类或 void）的名称</td></tr><tr><td>Class getSuperClass()</td><td>返回当前 Class 对象的父类的 Class 对象</td></tr><tr><td>Class[] getinterfaces()</td><td>获取当前 Class 对象的接口</td></tr><tr><td>ClassLoader getClassLoader()</td><td>返回该类的类加载器</td></tr><tr><td>Constructor[] getConstructors()</td><td>返回一个包含某些 Constructor 对象的数组</td></tr><tr><td>Method getMothed(String name.Class.. T)</td><td>返回一个 Method 对象，此对象的形参类型为 paramType</td></tr><tr><td>Field[] getDeclaredFields()</td><td>返回 Field 对象的一个数组</td></tr></tbody></table><hr><h3 id=获取-Class-类的实例><a href=#获取-Class-类的实例 class=headerlink title="获取 Class 类的实例"></a>获取 Class 类的实例</h3><ul><li>若已知具体的类，通过类的 class 属性获取，该方法最为安全可靠，程序性能最高<ul><li><code>Class c1 = Person.class;</code></li></ul></li><li>已知某个类的实例，调用该实例的 getClass()方法获取 Class 对象<ul><li><code>Class c2 =person.getClass()</code></li></ul></li><li>已知一个类的全类名，且该类在类路径下，可通过 Class 类的静态方法 forName()获取，可能抛出 ClassNotFoundException<ul><li><code>Class c3 = Class.forName(&quot;demo.Student&quot;)</code></li></ul></li><li>内置基本数据类型可以直接用类名.Type</li><li>ClassLoader</li></ul><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br></pre></td><td class=code><pre><span class=line><span class=comment>//Class类的创建方式</span></span><br><span class=line><span class=keyword>public</span> <span class=class><span class=keyword>class</span> <span class=title>Test03</span> </span>&#123;</span><br><span class=line>    <span class=function><span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class=title>main</span><span class=params>(String[] args)</span> <span class=keyword>throws</span> ClassNotFoundException </span>&#123;</span><br><span class=line>        Person person = <span class=keyword>new</span> Student();</span><br><span class=line>        System.out.println(<span class=string>"这个人是："</span> + person.name);</span><br><span class=line></span><br><span class=line>        <span class=comment>//方式一：通过对象获得</span></span><br><span class=line>        Class c1 = person.getClass();</span><br><span class=line>        System.out.println(c1); <span class=comment>//class ren.guard.reflection.Student</span></span><br><span class=line></span><br><span class=line>        <span class=comment>//方式二：forname获得</span></span><br><span class=line>        Class c2 = Class.forName(<span class=string>"ren.guard.reflection.Student"</span>);</span><br><span class=line>        System.out.println(c1 == c2); <span class=comment>//true</span></span><br><span class=line></span><br><span class=line>        <span class=comment>//方式三：通过类名.class获得</span></span><br><span class=line>        Class c3 = Student<span class=class>.<span class=keyword>class</span></span>;</span><br><span class=line>        System.out.println(c2 == c3); <span class=comment>//true</span></span><br><span class=line></span><br><span class=line>        <span class=comment>//方式四：基本内置类型的包装类有一个TYPE</span></span><br><span class=line>        Class c4 = Integer.TYPE;</span><br><span class=line>        System.out.println(c4); <span class=comment>//int</span></span><br><span class=line></span><br><span class=line>        <span class=comment>//获得父类类型</span></span><br><span class=line>        Class c5 = c1.getSuperclass();</span><br><span class=line>        System.out.println(c5); <span class=comment>//class ren.guard.reflection.Person</span></span><br><span class=line>    &#125;</span><br><span class=line></span><br><span class=line>&#125;</span><br><span class=line></span><br><span class=line><span class=class><span class=keyword>class</span> <span class=title>Person</span> </span>&#123;</span><br><span class=line>    <span class=keyword>public</span> String name;</span><br><span class=line></span><br><span class=line>    <span class=function><span class=keyword>public</span> <span class=title>Person</span><span class=params>()</span> </span>&#123;</span><br><span class=line>    &#125;</span><br><span class=line></span><br><span class=line>    <span class=function><span class=keyword>public</span> <span class=title>Person</span><span class=params>(String name)</span> </span>&#123;</span><br><span class=line>        <span class=keyword>this</span>.name = name;</span><br><span class=line>    &#125;</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=function><span class=keyword>public</span> String <span class=title>toString</span><span class=params>()</span> </span>&#123;</span><br><span class=line>        <span class=keyword>return</span> <span class=string>"Person&#123;"</span> +</span><br><span class=line>                <span class=string>"name='"</span> + name + <span class=string>'\''</span> +</span><br><span class=line>                <span class=string>'&#125;'</span>;</span><br><span class=line>    &#125;</span><br><span class=line>&#125;</span><br></pre></td></tr></table></figure><hr><h3 id=那些类型可以有-Class-对象><a href=#那些类型可以有-Class-对象 class=headerlink title="那些类型可以有 Class 对象"></a>那些类型可以有 Class 对象</h3><ul><li>class：外部类、成员（成员内部类，静态内部类），局部内部类，匿名内部类</li><li>interface：接口</li><li>[]：数组</li><li>enum：枚举</li><li>annotation：注解@interface</li><li>primitive type：基本数据类型</li><li>void</li></ul><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br></pre></td><td class=code><pre><span class=line><span class=function><span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class=title>main</span><span class=params>(String[] args)</span> </span>&#123;</span><br><span class=line>       Class c1 = Object<span class=class>.<span class=keyword>class</span></span>;<span class=comment>//类</span></span><br><span class=line>       Class c2 = Comparable<span class=class>.<span class=keyword>class</span></span>;<span class=comment>//接口</span></span><br><span class=line>       Class c3 = String[]<span class=class>.<span class=keyword>class</span></span>;<span class=comment>//一维数组</span></span><br><span class=line>       Class c4 = <span class=keyword>int</span>[][]<span class=class>.<span class=keyword>class</span></span>;<span class=comment>//二维数组</span></span><br><span class=line>       Class c5 = Override<span class=class>.<span class=keyword>class</span></span>;<span class=comment>//注解</span></span><br><span class=line>       Class c6 = ElementType<span class=class>.<span class=keyword>class</span></span>;<span class=comment>//枚举</span></span><br><span class=line>       Class c7 = Integer<span class=class>.<span class=keyword>class</span></span>;<span class=comment>//基本数据类型</span></span><br><span class=line>       Class c8 = <span class=keyword>void</span><span class=class>.<span class=keyword>class</span></span>;<span class=comment>//void</span></span><br><span class=line>       Class c9 = Class<span class=class>.<span class=keyword>class</span></span>;<span class=comment>//Class</span></span><br><span class=line></span><br><span class=line>       System.out.println(c1);<span class=comment>//class java.lang.Object</span></span><br><span class=line>       System.out.println(c2);<span class=comment>//interface java.lang.Comparable</span></span><br><span class=line>       System.out.println(c3);<span class=comment>//class [Ljava.lang.String;</span></span><br><span class=line>       System.out.println(c4);<span class=comment>//class [[I</span></span><br><span class=line>       System.out.println(c5);<span class=comment>//interface java.lang.Override</span></span><br><span class=line>       System.out.println(c6);<span class=comment>//class java.lang.annotation.ElementType</span></span><br><span class=line>       System.out.println(c7);<span class=comment>//class java.lang.Integer</span></span><br><span class=line>       System.out.println(c8);<span class=comment>//void</span></span><br><span class=line>       System.out.println(c9);<span class=comment>//class java.lang.Class</span></span><br><span class=line></span><br><span class=line>       <span class=comment>//只要元素类型和维度一样，就是同一个Class</span></span><br><span class=line>       <span class=keyword>int</span>[] a = <span class=keyword>new</span> <span class=keyword>int</span>[<span class=number>10</span>];</span><br><span class=line>       <span class=keyword>int</span>[] b = <span class=keyword>new</span> <span class=keyword>int</span>[<span class=number>100</span>];</span><br><span class=line>       System.out.println(a.getClass() == b.getClass());<span class=comment>//true</span></span><br><span class=line>   &#125;</span><br></pre></td></tr></table></figure><hr><h2 id=类的加载与-ClassLoader><a href=#类的加载与-ClassLoader class=headerlink title="类的加载与 ClassLoader"></a>类的加载与 ClassLoader</h2><h3 id=Java-内存分析><a href=#Java-内存分析 class=headerlink title="Java 内存分析"></a>Java 内存分析</h3><h2><a href=# class=headerlink></a><img data-src=https://cdn.nlark.com/yuque/0/2020/svg/241578/1584421598454-62a1ca39-0658-4273-8b5a-a2f5f1cbebe5.svg></h2><h3 id=类的加载过程><a href=#类的加载过程 class=headerlink title=类的加载过程></a>类的加载过程</h3><p>当程序主动使用某个类时，如果该类还未被加载到内存中，则系统会通过如下三个步骤来对该类进行初始化。</p><p><img data-src="https://cdn.nlark.com/yuque/0/2020/png/241578/1584421646211-dfca5653-f62f-4af1-9fae-aa3a80e6f982.png#align=left&display=inline&height=322&name=image.png&originHeight=322&originWidth=752&size=197916&status=done&style=none&width=752" alt=image.png></p><ul><li>加载：将 class 文件字节码内容加载到内存中，并将这些静态数据转换成方法区的运行时数据结构，然后生成一个代表这个类的 java.lang.Class 对象</li><li>链接：将 Java 类的二进制代码合并到 JVM 的运行状态之中的过程<ul><li>验证：确保加载的类信息符合 JVM 规范，没有安全方面的问题</li><li>准备：正式为类变量（static）分配内存并设置类变量默认初始值的阶段，这些内存都将在方法区中进行分配</li><li>解析：虚拟机常量池内的符号引用（常量名）替换为直接引用（地址）的过程</li></ul></li><li>初始化<ul><li>执行类构造器<clinit>（）方法的过程。类构造器<clinit>（）方法是由编译期自动收集类中所有类变量的赋值动作和静态代码块中的语句合并产生的。（类构造器是构造类信息的，不是构造该类对象的构造器）</clinit></clinit></li><li>当初始化一个类的时候，如果发现其父类还没有进行初始化，则需要先触发其父类的初始化</li><li>虚拟机会保证一个类的<clinit>（）方法在多线程环境中被正确加锁和同步</clinit></li></ul></li></ul><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br></pre></td><td class=code><pre><span class=line><span class=keyword>public</span> <span class=class><span class=keyword>class</span> <span class=title>Test05</span> </span>&#123;</span><br><span class=line>    <span class=function><span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class=title>main</span><span class=params>(String[] args)</span> </span>&#123;</span><br><span class=line>        A a = <span class=keyword>new</span> A();</span><br><span class=line>        System.out.println(A.m);</span><br><span class=line></span><br><span class=line>        <span class=comment>/*</span></span><br><span class=line><span class=comment>        1.加载到内存,会产生一个类对应Class对象</span></span><br><span class=line><span class=comment>        2.链接,链接结束后m=0</span></span><br><span class=line><span class=comment>        3.初始化</span></span><br><span class=line><span class=comment>            &lt;clinit&gt;()&#123;</span></span><br><span class=line><span class=comment>                System.out.println("A类静态代码块初始化");</span></span><br><span class=line><span class=comment>                m = 300;</span></span><br><span class=line><span class=comment>                m = 100;</span></span><br><span class=line><span class=comment>            &#125;</span></span><br><span class=line><span class=comment>         */</span></span><br><span class=line></span><br><span class=line>        <span class=comment>//A类静态代码块初始化</span></span><br><span class=line>        <span class=comment>//A类的无参构造初始化</span></span><br><span class=line>        <span class=comment>//100</span></span><br><span class=line>    &#125;</span><br><span class=line>&#125;</span><br><span class=line></span><br><span class=line><span class=class><span class=keyword>class</span> <span class=title>A</span> </span>&#123;</span><br><span class=line></span><br><span class=line>    <span class=keyword>static</span> &#123;</span><br><span class=line>        System.out.println(<span class=string>"A类静态代码块初始化"</span>);</span><br><span class=line>        m = <span class=number>300</span>;</span><br><span class=line>    &#125;</span><br><span class=line></span><br><span class=line>    <span class=keyword>static</span> <span class=keyword>int</span> m = <span class=number>100</span>;</span><br><span class=line></span><br><span class=line>    <span class=function><span class=keyword>public</span> <span class=title>A</span><span class=params>()</span> </span>&#123;</span><br><span class=line>        System.out.println(<span class=string>"A类的无参构造初始化"</span>);</span><br><span class=line>    &#125;</span><br><span class=line>&#125;</span><br></pre></td></tr></table></figure><hr><h3 id=什么时候会发生类初始化><a href=#什么时候会发生类初始化 class=headerlink title=什么时候会发生类初始化></a>什么时候会发生类初始化</h3><ul><li>类的主动引用（一定会发生类的初始化）<ul><li>当虚拟机启动，先初始化 main 方法所在的类</li><li>new 一个类的对象</li><li>调用类的静态成员（除了 final 常量）和静态方法</li><li>使用 java.lang.reflect 包的方法对类进行反射调用</li><li>当初始化一个类，如果其父类没有被初始化，则先会初始化它的父类</li></ul></li><li>类的被动引用（不会发生类的初始化）<ul><li>当访问一个静态域时，只有真正声明这个域的类才会被初始化。如：当通过子类引用父类的静态变量，不会导致子类初始化</li><li>通过数组定义类引用，不会触发此类的初始化</li><li>引用常量不会触发此类的初始化（常量在链接阶段就存入调用类的常量池中了）</li></ul></li></ul><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br></pre></td><td class=code><pre><span class=line><span class=comment>//类什么时候会初始化</span></span><br><span class=line><span class=keyword>public</span> <span class=class><span class=keyword>class</span> <span class=title>Test06</span> </span>&#123;</span><br><span class=line>    <span class=keyword>static</span> &#123;</span><br><span class=line>        System.out.println(<span class=string>"Main类被加载"</span>);</span><br><span class=line>    &#125;</span><br><span class=line></span><br><span class=line>    <span class=function><span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class=title>main</span><span class=params>(String[] args)</span> <span class=keyword>throws</span> ClassNotFoundException </span>&#123;</span><br><span class=line>        <span class=comment>//1.主动引用</span></span><br><span class=line>        <span class=comment>//Son son = new Son();</span></span><br><span class=line>        <span class=comment>//Main类被加载</span></span><br><span class=line>        <span class=comment>//父类被加载</span></span><br><span class=line>        <span class=comment>//子类被加载</span></span><br><span class=line></span><br><span class=line>        <span class=comment>//2.反射也会产生主动引用</span></span><br><span class=line>        <span class=comment>//Class.forName("ren.guard.reflection.Son");</span></span><br><span class=line>        <span class=comment>//Main类被加载</span></span><br><span class=line>        <span class=comment>//父类被加载</span></span><br><span class=line>        <span class=comment>//子类被加载</span></span><br><span class=line></span><br><span class=line>        <span class=comment>//不會产生类的引用</span></span><br><span class=line></span><br><span class=line>        <span class=comment>//System.out.println(Son.b);</span></span><br><span class=line>        <span class=comment>//Main类被加载</span></span><br><span class=line>        <span class=comment>//父类被加载</span></span><br><span class=line>        <span class=comment>//2</span></span><br><span class=line></span><br><span class=line>        <span class=comment>//Son[] array = new Son[5];</span></span><br><span class=line>        <span class=comment>//Main类被加载</span></span><br><span class=line></span><br><span class=line>        <span class=comment>//System.out.println(Son.M);</span></span><br><span class=line>        <span class=comment>//Main类被加载</span></span><br><span class=line>        <span class=comment>//1</span></span><br><span class=line>    &#125;</span><br><span class=line>&#125;</span><br><span class=line></span><br><span class=line><span class=class><span class=keyword>class</span> <span class=title>Father</span> </span>&#123;</span><br><span class=line>    <span class=keyword>static</span> <span class=keyword>int</span> b = <span class=number>2</span>;</span><br><span class=line></span><br><span class=line>    <span class=keyword>static</span> &#123;</span><br><span class=line>        System.out.println(<span class=string>"父类被加载"</span>);</span><br><span class=line>    &#125;</span><br><span class=line>&#125;</span><br><span class=line></span><br><span class=line><span class=class><span class=keyword>class</span> <span class=title>Son</span> <span class=keyword>extends</span> <span class=title>Father</span> </span>&#123;</span><br><span class=line>    <span class=keyword>static</span> &#123;</span><br><span class=line>        System.out.println(<span class=string>"子类被加载"</span>);</span><br><span class=line>        m = <span class=number>300</span>;</span><br><span class=line>    &#125;</span><br><span class=line></span><br><span class=line>    <span class=keyword>static</span> <span class=keyword>int</span> m = <span class=number>100</span>;</span><br><span class=line>    <span class=keyword>static</span> <span class=keyword>final</span> <span class=keyword>int</span> M = <span class=number>1</span>;</span><br><span class=line>&#125;</span><br></pre></td></tr></table></figure><hr><h3 id=类加载器的作用><a href=#类加载器的作用 class=headerlink title=类加载器的作用></a>类加载器的作用</h3><ul><li>类加载的作用：将 class 文件字节码内容加载到内存中，并将这些静态数据转换成方法区的运行时数据结构，然后在堆中生成一个代表这个类的 java.lang.Class 对象，作为方法区中类数据的访问入口</li><li>类缓存：标准的 JavaSE 类加载器可以按要求查找类，但一旦某个类被加载到类加载器中，它将维持加载（缓存）一段时间。不过 VM 垃圾回收机制可以回收这些 Class 对象</li></ul><p><img data-src="https://cdn.nlark.com/yuque/0/2020/jpeg/241578/1584424373550-ba66b4b3-bb74-41bd-a9c3-ecaa89fc17e5.jpeg#align=left&display=inline&height=277&originHeight=277&originWidth=600&size=0&status=done&style=none&width=600"><br>类加载器作用是用来把类（class）装载进内存的。JVM 规范定义了如下类型的类的加载器</p><ul><li>引导类加载器：用 C++编写的，是 JVM 自带的类加载器，负责 Java 平台核心库，用来装载核心类库。该加载器无法直接获取</li><li>扩展类加载器：负责 jre/lib/ext 目录下的 jar 包或-D java.ext.dirs 指定目录下的 jar 包装入工作库</li><li>系统类加载器：负责 java-classpath 或-D java.class.path 所指的目录下的类与 jar 包装入工作，是最常用的加载器</li></ul><p><img data-src="https://cdn.nlark.com/yuque/0/2020/jpeg/241578/1584424597049-d22e1fb1-600a-459e-a701-7c8139897dea.jpeg#align=left&display=inline&height=441&originHeight=441&originWidth=690&size=0&status=done&style=none&width=690"></p><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br></pre></td><td class=code><pre><span class=line><span class=function><span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class=title>main</span><span class=params>(String[] args)</span> <span class=keyword>throws</span> ClassNotFoundException </span>&#123;</span><br><span class=line>    <span class=comment>//获取系统类的加载器</span></span><br><span class=line>    ClassLoader systemClassLoader = ClassLoader.getSystemClassLoader();</span><br><span class=line>    System.out.println(systemClassLoader);<span class=comment>//sun.misc.Launcher$AppClassLoader@18b4aac2</span></span><br><span class=line></span><br><span class=line>    <span class=comment>//获取系统类加载器的父类加载器--&gt;拓展类加载器</span></span><br><span class=line>    ClassLoader parent = systemClassLoader.getParent();</span><br><span class=line>    System.out.println(parent);<span class=comment>//sun.misc.Launcher$ExtClassLoader@4554617c</span></span><br><span class=line></span><br><span class=line>    <span class=comment>//获取扩展类加载器的父类加载器--&gt;根加载器(C/C++)</span></span><br><span class=line>    System.out.println(parent.getParent()); <span class=comment>//null</span></span><br><span class=line></span><br><span class=line>    <span class=comment>//当前类时那个加载器加载的</span></span><br><span class=line>    ClassLoader classLoader = Class.forName(<span class=string>"ren.guard.reflection.Test07"</span>).getClassLoader();</span><br><span class=line>    System.out.println(classLoader);<span class=comment>//sun.misc.Launcher$AppClassLoader@18b4aac2</span></span><br><span class=line></span><br><span class=line>    <span class=comment>//JDK内置类</span></span><br><span class=line>    classLoader = Class.forName(<span class=string>"java.lang.Object"</span>).getClassLoader();</span><br><span class=line>    System.out.println(classLoader);<span class=comment>//null</span></span><br><span class=line></span><br><span class=line>    <span class=comment>//如何获得系统类加载器可以加载的路径</span></span><br><span class=line>    String property = System.getProperty(<span class=string>"java.class.path"</span>);</span><br><span class=line>    String[] split = property.split(<span class=string>";"</span>);</span><br><span class=line>    <span class=keyword>for</span> (String s : split) &#123;</span><br><span class=line>        System.out.println(s);</span><br><span class=line>    &#125;</span><br><span class=line>    <span class=comment>/**</span></span><br><span class=line><span class=comment>     * E:\Java\jdk1.8.0_181\jre\lib\charsets.jar</span></span><br><span class=line><span class=comment>     * E:\Java\jdk1.8.0_181\jre\lib\deploy.jar</span></span><br><span class=line><span class=comment>     * E:\Java\jdk1.8.0_181\jre\lib\ext\access-bridge-64.jar</span></span><br><span class=line><span class=comment>     * E:\Java\jdk1.8.0_181\jre\lib\ext\cldrdata.jar</span></span><br><span class=line><span class=comment>     * E:\Java\jdk1.8.0_181\jre\lib\ext\dnsns.jar</span></span><br><span class=line><span class=comment>     * E:\Java\jdk1.8.0_181\jre\lib\ext\jaccess.jar</span></span><br><span class=line><span class=comment>     * E:\Java\jdk1.8.0_181\jre\lib\ext\jfxrt.jar</span></span><br><span class=line><span class=comment>     * E:\Java\jdk1.8.0_181\jre\lib\ext\localedata.jar</span></span><br><span class=line><span class=comment>     * E:\Java\jdk1.8.0_181\jre\lib\ext\nashorn.jar</span></span><br><span class=line><span class=comment>     * E:\Java\jdk1.8.0_181\jre\lib\ext\sunec.jar</span></span><br><span class=line><span class=comment>     * E:\Java\jdk1.8.0_181\jre\lib\ext\sunjce_provider.jar</span></span><br><span class=line><span class=comment>     * E:\Java\jdk1.8.0_181\jre\lib\ext\sunmscapi.jar</span></span><br><span class=line><span class=comment>     * E:\Java\jdk1.8.0_181\jre\lib\ext\sunpkcs11.jar</span></span><br><span class=line><span class=comment>     * E:\Java\jdk1.8.0_181\jre\lib\ext\zipfs.jar</span></span><br><span class=line><span class=comment>     * E:\Java\jdk1.8.0_181\jre\lib\javaws.jar</span></span><br><span class=line><span class=comment>     * E:\Java\jdk1.8.0_181\jre\lib\jce.jar</span></span><br><span class=line><span class=comment>     * E:\Java\jdk1.8.0_181\jre\lib\jfr.jar</span></span><br><span class=line><span class=comment>     * E:\Java\jdk1.8.0_181\jre\lib\jfxswt.jar</span></span><br><span class=line><span class=comment>     * E:\Java\jdk1.8.0_181\jre\lib\jsse.jar</span></span><br><span class=line><span class=comment>     * E:\Java\jdk1.8.0_181\jre\lib\management-agent.jar</span></span><br><span class=line><span class=comment>     * E:\Java\jdk1.8.0_181\jre\lib\plugin.jar</span></span><br><span class=line><span class=comment>     * E:\Java\jdk1.8.0_181\jre\lib\resources.jar</span></span><br><span class=line><span class=comment>     * E:\Java\jdk1.8.0_181\jre\lib\rt.jar</span></span><br><span class=line><span class=comment>     * E:\ShiYi\Idea\注解和反射\out\production\注解和反射</span></span><br><span class=line><span class=comment>     * D:\IntelliJ IDEA 2018.2.1\lib\idea_rt.jar</span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line></span><br><span class=line>    <span class=comment>//双亲委派机制</span></span><br><span class=line>    <span class=comment>//相同的类名，Java加载器只会应用，自身的类</span></span><br><span class=line>&#125;</span><br></pre></td></tr></table></figure><hr><h2 id=获取运行时类的完整结构><a href=#获取运行时类的完整结构 class=headerlink title=获取运行时类的完整结构></a>获取运行时类的完整结构</h2><p>通过反射获取运行时类的完整结构<br>Field(字段)、Method(方法)、Constructor(构造器)、Superclass(父类)、Interface(接口)、Annotation(注解)</p><ul><li>实现的接口</li><li>所继承的父类</li><li>全部的构造器</li><li>全部的方法</li><li>全部 Field</li><li>注解</li><li>……</li></ul><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br></pre></td><td class=code><pre><span class=line><span class=function><span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class=title>main</span><span class=params>(String[] args)</span> <span class=keyword>throws</span> ClassNotFoundException, NoSuchFieldException, NoSuchMethodException </span>&#123;</span><br><span class=line>    Class c1 = Class.forName(<span class=string>"ren.guard.reflection.User"</span>);</span><br><span class=line></span><br><span class=line>    <span class=comment>//获得类的名字</span></span><br><span class=line>    <span class=comment>//获得包名 + 类名</span></span><br><span class=line>    System.out.println(c1.getName());<span class=comment>//ren.guard.reflection.User</span></span><br><span class=line>    <span class=comment>//获得类名</span></span><br><span class=line>    System.out.println(c1.getSimpleName());<span class=comment>//User</span></span><br><span class=line></span><br><span class=line>    <span class=comment>//获得类的属性</span></span><br><span class=line>    System.out.println(<span class=string>"=================================="</span>);</span><br><span class=line>    Field[] fields = c1.getFields(); <span class=comment>//只能找到public属性</span></span><br><span class=line>    <span class=keyword>for</span> (Field field : fields) &#123;</span><br><span class=line>        System.out.println(<span class=string>"getFields："</span> + field);</span><br><span class=line>        <span class=comment>/*</span></span><br><span class=line><span class=comment>         无</span></span><br><span class=line><span class=comment>         */</span></span><br><span class=line>    &#125;</span><br><span class=line></span><br><span class=line>    <span class=comment>//找到全部的属性</span></span><br><span class=line>    Field[] declaredFields = c1.getDeclaredFields();</span><br><span class=line>    <span class=keyword>for</span> (Field field : declaredFields) &#123;</span><br><span class=line>        System.out.println(<span class=string>"getDeclaredFields："</span> + field);</span><br><span class=line>        <span class=comment>/*</span></span><br><span class=line><span class=comment>        private int ren.guard.reflection.User.id</span></span><br><span class=line><span class=comment>        private java.lang.String ren.guard.reflection.User.name</span></span><br><span class=line><span class=comment>        private int ren.guard.reflection.User.age</span></span><br><span class=line><span class=comment>         */</span></span><br><span class=line>    &#125;</span><br><span class=line></span><br><span class=line>    <span class=comment>//获得指定属性的值</span></span><br><span class=line>    <span class=comment>//只能获得public</span></span><br><span class=line>    <span class=comment>//Field name = c1.getField("name"); //Exception in thread "main" java.lang.NoSuchFieldException: name</span></span><br><span class=line>    Field name = c1.getDeclaredField(<span class=string>"name"</span>);</span><br><span class=line>    System.out.println(name);<span class=comment>//private java.lang.String ren.guard.reflection.User.name</span></span><br><span class=line></span><br><span class=line>    <span class=comment>//获得类的方法</span></span><br><span class=line>    System.out.println(<span class=string>"=================================="</span>);</span><br><span class=line>    <span class=comment>//获得本类己其父类的全部public方法</span></span><br><span class=line>    Method[] methods = c1.getMethods();</span><br><span class=line>    <span class=keyword>for</span> (Method method : methods) &#123;</span><br><span class=line>        System.out.println(<span class=string>"getMethods："</span> + method);</span><br><span class=line>    &#125;</span><br><span class=line>    <span class=comment>//获得本类的所有方法</span></span><br><span class=line>    Method[] declaredMethods = c1.getDeclaredMethods();</span><br><span class=line>    <span class=keyword>for</span> (Method method : declaredMethods) &#123;</span><br><span class=line>        System.out.println(<span class=string>"getDeclaredMethods："</span> + method);</span><br><span class=line>    &#125;</span><br><span class=line></span><br><span class=line>    <span class=comment>//获得指定方法</span></span><br><span class=line>    <span class=comment>//重载</span></span><br><span class=line>    Method getName = c1.getMethod(<span class=string>"getName"</span>, <span class=keyword>null</span>);</span><br><span class=line>    System.out.println(getName);<span class=comment>//public java.lang.String ren.guard.reflection.User.getName()</span></span><br><span class=line>    Method setName = c1.getMethod(<span class=string>"setName"</span>, String<span class=class>.<span class=keyword>class</span>)</span>;</span><br><span class=line>    System.out.println(setName);<span class=comment>//public void ren.guard.reflection.User.setName(java.lang.String)</span></span><br><span class=line></span><br><span class=line>    <span class=comment>//获得指定的构造器</span></span><br><span class=line>    System.out.println(<span class=string>"=================================="</span>);</span><br><span class=line>    Constructor[] constructors = c1.getConstructors();</span><br><span class=line>    <span class=keyword>for</span> (Constructor constructor : constructors) &#123;</span><br><span class=line>        System.out.println(<span class=string>"getConstructors："</span> + constructor);</span><br><span class=line>        <span class=comment>/*</span></span><br><span class=line><span class=comment>        public ren.guard.reflection.User()</span></span><br><span class=line><span class=comment>        public ren.guard.reflection.User(int,java.lang.String,int)</span></span><br><span class=line><span class=comment>         */</span></span><br><span class=line>    &#125;</span><br><span class=line></span><br><span class=line>    Constructor[] declaredConstructors = c1.getDeclaredConstructors();</span><br><span class=line>    <span class=keyword>for</span> (Constructor constructor : declaredConstructors) &#123;</span><br><span class=line>        System.out.println(<span class=string>"declaredConstructors："</span> + constructor);</span><br><span class=line>        <span class=comment>/*</span></span><br><span class=line><span class=comment>        public ren.guard.reflection.User()</span></span><br><span class=line><span class=comment>        public ren.guard.reflection.User(int,java.lang.String,int)</span></span><br><span class=line><span class=comment>         */</span></span><br><span class=line>    &#125;</span><br><span class=line></span><br><span class=line>    <span class=comment>//获得指定的构造器</span></span><br><span class=line>    Constructor declaredConstructor = c1.getDeclaredConstructor(<span class=keyword>int</span><span class=class>.<span class=keyword>class</span>, <span class=title>String</span>.<span class=title>class</span>, <span class=title>int</span>.<span class=title>class</span>)</span>;</span><br><span class=line>    System.out.println(<span class=string>"指定："</span> + declaredConstructor); <span class=comment>//public ren.guard.reflection.User(int,java.lang.String,int)</span></span><br><span class=line>&#125;</span><br></pre></td></tr></table></figure><hr><h2 id=反射><a href=#反射 class=headerlink title=反射></a>反射</h2><h3 id=创建对象><a href=#创建对象 class=headerlink title=创建对象></a>创建对象</h3><p>有无参构造器时：</p><ul><li>调用 Class 对象的 newInstance()方法</li><li>类必须有一个无参构造器</li><li>要有类的构造器的访问权限</li></ul><p>没有无参构造器时：</p><ul><li>通过 Class 类的 getDeclaredConstructor(Class … parameterTypes)取得本类的指定形参类型的构造器</li><li>向构造器的形参中传递一个对象数组进去，里面包含了构造器中所需要的各个参数</li><li>通过 Constructor 实例化对象</li></ul><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br></pre></td><td class=code><pre><span class=line><span class=function><span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class=title>main</span><span class=params>(String[] args)</span> <span class=keyword>throws</span> ClassNotFoundException, IllegalAccessException, InstantiationException, NoSuchMethodException, InvocationTargetException, NoSuchFieldException </span>&#123;</span><br><span class=line>    <span class=comment>//获得class对象</span></span><br><span class=line>    Class c1 = Class.forName(<span class=string>"ren.guard.reflection.User"</span>);</span><br><span class=line>    <span class=comment>//构造一个对象</span></span><br><span class=line>    User user = (User) c1.newInstance();<span class=comment>//本质上是调用了类的无参构造器</span></span><br><span class=line>    System.out.println(user);<span class=comment>//User&#123;id=0, name='null', age=0&#125;</span></span><br><span class=line></span><br><span class=line>    <span class=comment>//通过构造器创建对象</span></span><br><span class=line>    Constructor constructor = c1.getDeclaredConstructor(<span class=keyword>int</span><span class=class>.<span class=keyword>class</span>, <span class=title>String</span>.<span class=title>class</span>, <span class=title>int</span>.<span class=title>class</span>)</span>;</span><br><span class=line>    user = (User) constructor.newInstance(<span class=number>1</span>, <span class=string>"xxx"</span>, <span class=number>2</span>);</span><br><span class=line>    System.out.println(user);<span class=comment>//User&#123;id=1, name='xxx', age=2&#125;</span></span><br><span class=line></span><br><span class=line>    <span class=comment>//通过反射调用普通方法</span></span><br><span class=line>    user = (User) c1.newInstance();</span><br><span class=line>    <span class=comment>//通过反射获取一个方法</span></span><br><span class=line>    Method setName = c1.getDeclaredMethod(<span class=string>"setName"</span>, String<span class=class>.<span class=keyword>class</span>)</span>;</span><br><span class=line>    <span class=comment>//invoke:激活（对象，"方法值"）</span></span><br><span class=line>    setName.invoke(user,<span class=string>"yyy"</span>);</span><br><span class=line>    System.out.println(user);<span class=comment>//User&#123;id=0, name='yyy', age=0&#125;</span></span><br><span class=line></span><br><span class=line>    <span class=comment>//通过反射操作属性</span></span><br><span class=line>    user = (User) c1.newInstance();</span><br><span class=line>    Field name = c1.getDeclaredField(<span class=string>"name"</span>);</span><br><span class=line>    <span class=comment>//不能直接操作私有属性，需要关闭程序的安全检测，属性或者方法的setAccessible(true);</span></span><br><span class=line>    name.setAccessible(<span class=keyword>true</span>);</span><br><span class=line>    name.set(user,<span class=string>"zzz"</span>);</span><br><span class=line>    System.out.println(user);<span class=comment>//User&#123;id=0, name='zzz', age=0&#125;</span></span><br><span class=line>&#125;</span><br></pre></td></tr></table></figure><hr><h3 id=调用指定的方法><a href=#调用指定的方法 class=headerlink title=调用指定的方法></a>调用指定的方法</h3><p>通过反射，调用类中的方法，通过 Method 类完成</p><ul><li><p>通过 Class 类的 getMethod（String name，Class…parameterTypes）方法取一个 Method 对象，并设置此方法操作时所需要的参数类型</p></li><li><p>之后使用 Object invoke（Object obj，ObjectI]args）进行调用，并向方法中传递要设置的 obj 对象的参数信息</p></li><li><p><img data-src="https://cdn.nlark.com/yuque/0/2020/png/241578/1584590106574-28cfb7b6-f8a6-4b51-9abe-d7c33e101311.png#align=left&display=inline&height=330&name=image.png&originHeight=330&originWidth=1309&size=253830&status=done&style=none&width=1309" alt=image.png></p></li><li><p>Object invoke(Object obj, Object … args)</p><ul><li>Object 对应原方法的返回值，若原方法无返回值，此时返回 null</li><li>若原方法若为静态方法，此时形参 Object obj 可为 null</li><li>若原方法形参列表为空，则 Object]args 为 null</li><li>若原方法声明为 private，则需要在调用此 invoke（）方法前，显式调用方法对象的 setAccessible（true）方法，将可访问 private 的方法。</li><li>setAccessible<ul><li>Method 和 Field、Constructor 对象都有 setAccessible（）方法。</li><li>setAccessible 作用是启动和禁用访问安全检查的开关。</li><li>参数值为 true 则指示反射的对象在使用时应该取消 Java 语言访问检查。<ul><li>提高反射的效率。如果代码中必须用反射，而该句代码需要频繁的被调用，那么请设置为 true.</li><li>使得原本无法访问的私有成员也可以访问</li></ul></li><li>参数值为 false 则指示反射的对象应该实施 Java 语言访问检查</li></ul></li></ul></li></ul><hr><h3 id=反射性能测试><a href=#反射性能测试 class=headerlink title=反射性能测试></a>反射性能测试</h3><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br></pre></td><td class=code><pre><span class=line><span class=comment>//new User</span></span><br><span class=line><span class=function><span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class=title>test01</span><span class=params>()</span> </span>&#123;</span><br><span class=line>    User user = <span class=keyword>new</span> User();</span><br><span class=line>    <span class=keyword>long</span> startTime = System.currentTimeMillis();</span><br><span class=line>    <span class=keyword>for</span> (<span class=keyword>int</span> i = <span class=number>0</span>; i &lt; <span class=number>1000000000</span>; i++) &#123;</span><br><span class=line>        user.getName();</span><br><span class=line>    &#125;</span><br><span class=line>    <span class=keyword>long</span> endTime = System.currentTimeMillis();</span><br><span class=line>    System.out.println(<span class=string>"new User :"</span> + (endTime - startTime) + <span class=string>"ms"</span>);</span><br><span class=line>&#125;</span><br><span class=line></span><br><span class=line><span class=comment>//反射调用</span></span><br><span class=line><span class=function><span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class=title>test02</span><span class=params>()</span> <span class=keyword>throws</span> NoSuchMethodException, InvocationTargetException, IllegalAccessException </span>&#123;</span><br><span class=line>    User user = <span class=keyword>new</span> User();</span><br><span class=line>    Class c1 = user.getClass();</span><br><span class=line>    Method getName = c1.getDeclaredMethod(<span class=string>"getName"</span>, <span class=keyword>null</span>);</span><br><span class=line>    <span class=keyword>long</span> startTime = System.currentTimeMillis();</span><br><span class=line>    <span class=keyword>for</span> (<span class=keyword>int</span> i = <span class=number>0</span>; i &lt; <span class=number>1000000000</span>; i++) &#123;</span><br><span class=line>        getName.invoke(user, <span class=keyword>null</span>);</span><br><span class=line>    &#125;</span><br><span class=line>    <span class=keyword>long</span> endTime = System.currentTimeMillis();</span><br><span class=line>    System.out.println(<span class=string>"反射调用 :"</span> + (endTime - startTime) + <span class=string>"ms"</span>);</span><br><span class=line>&#125;</span><br><span class=line></span><br><span class=line><span class=comment>//反射调用 关闭检测</span></span><br><span class=line><span class=function><span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class=title>test03</span><span class=params>()</span> <span class=keyword>throws</span> NoSuchMethodException, InvocationTargetException, IllegalAccessException </span>&#123;</span><br><span class=line>    User user = <span class=keyword>new</span> User();</span><br><span class=line>    Class c1 = user.getClass();</span><br><span class=line>    Method getName = c1.getDeclaredMethod(<span class=string>"getName"</span>, <span class=keyword>null</span>);</span><br><span class=line>    getName.setAccessible(<span class=keyword>true</span>);</span><br><span class=line>    <span class=keyword>long</span> startTime = System.currentTimeMillis();</span><br><span class=line>    <span class=keyword>for</span> (<span class=keyword>int</span> i = <span class=number>0</span>; i &lt; <span class=number>1000000000</span>; i++) &#123;</span><br><span class=line>        getName.invoke(user, <span class=keyword>null</span>);</span><br><span class=line>    &#125;</span><br><span class=line>    <span class=keyword>long</span> endTime = System.currentTimeMillis();</span><br><span class=line>    System.out.println(<span class=string>"反射调用 关闭检测 :"</span> + (endTime - startTime) + <span class=string>"ms"</span>);</span><br><span class=line>&#125;</span><br><span class=line><span class=function><span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class=title>main</span><span class=params>(String[] args)</span> <span class=keyword>throws</span> NoSuchMethodException, IllegalAccessException, InvocationTargetException </span>&#123;</span><br><span class=line>  test01();<span class=comment>//new User :4ms</span></span><br><span class=line>  test02();<span class=comment>//反射调用 :2779ms</span></span><br><span class=line>  test03();<span class=comment>//反射调用 关闭检测 :1825ms</span></span><br><span class=line>&#125;</span><br></pre></td></tr></table></figure><hr><h3 id=反射操作泛型><a href=#反射操作泛型 class=headerlink title=反射操作泛型></a>反射操作泛型</h3><ul><li>Java 采用泛型擦除的机制来引入泛型，Java 中的泛型仅仅是给编译器 javac 使用的，确保数据的安全性和免去强制类型转换问题，但是，一旦编译完成，所有和泛型有关的类型全部擦除</li><li>为了通过反射操作这些类型，Java 新增了 ParameterizedType，GenericArrayType TypeVariable 和 WildcardType 几种类型来代表不能被归一到 Class 类中的类型但是又和原始类型齐名的类型<ul><li>ParameterizedType：表示一种参数化类型，比如 Collection<string></string></li><li>GenericArrayType：表示一种元素类型是参数化类型或者类型变量的数组类型</li><li>TypeVariable：是各种类型变量的公共父接口</li><li>WildcardType：代表一种通配符类型表达式</li></ul></li></ul><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br></pre></td><td class=code><pre><span class=line><span class=function><span class=keyword>public</span> <span class=keyword>void</span> <span class=title>test01</span><span class=params>(Map&lt;String,User&gt; map , List&lt;User&gt; list)</span></span>&#123;</span><br><span class=line>    System.out.println(<span class=string>"test01"</span>);</span><br><span class=line>&#125;</span><br><span class=line><span class=function><span class=keyword>public</span> Map&lt;String,User&gt; <span class=title>test02</span><span class=params>()</span></span>&#123;</span><br><span class=line>    System.out.println(<span class=string>"test02"</span>);</span><br><span class=line>    <span class=keyword>return</span> <span class=keyword>null</span>;</span><br><span class=line>&#125;</span><br><span class=line><span class=function><span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class=title>main</span><span class=params>(String[] args)</span> <span class=keyword>throws</span> NoSuchMethodException </span>&#123;</span><br><span class=line>    Method test01 = Test11.class.getMethod("test01", Map.class, List.class);</span><br><span class=line>    Type[] genericParameterTypes = test01.getGenericParameterTypes();</span><br><span class=line>    <span class=keyword>for</span> (Type type : genericParameterTypes) &#123;</span><br><span class=line>        System.out.println(type);</span><br><span class=line>        <span class=keyword>if</span>(type <span class=keyword>instanceof</span> ParameterizedType)&#123;</span><br><span class=line>            Type[] actualTypeArguments = ((ParameterizedType) type).getActualTypeArguments();</span><br><span class=line>            <span class=keyword>for</span> (Type actualTypeArgument : actualTypeArguments) &#123;</span><br><span class=line>                System.out.println(actualTypeArgument);</span><br><span class=line>            &#125;</span><br><span class=line>        &#125;</span><br><span class=line>    &#125;</span><br><span class=line>    <span class=comment>/**</span></span><br><span class=line><span class=comment>     * java.util.Map&lt;java.lang.String, ren.guard.reflection.User&gt;</span></span><br><span class=line><span class=comment>     * class java.lang.String</span></span><br><span class=line><span class=comment>     * class ren.guard.reflection.User</span></span><br><span class=line><span class=comment>     * java.util.List&lt;ren.guard.reflection.User&gt;</span></span><br><span class=line><span class=comment>     * class ren.guard.reflection.User</span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line>    System.out.println(<span class=string>"=================================="</span>);</span><br><span class=line>    Method test02 = Test11.class.getMethod("test02",null);</span><br><span class=line>    Type genericReturnType = test02.getGenericReturnType();</span><br><span class=line>    <span class=keyword>if</span>(genericReturnType <span class=keyword>instanceof</span> ParameterizedType)&#123;</span><br><span class=line>        Type[] actualTypeArguments = ((ParameterizedType) genericReturnType).getActualTypeArguments();</span><br><span class=line>        <span class=keyword>for</span> (Type actualTypeArgument : actualTypeArguments) &#123;</span><br><span class=line>            System.out.println(actualTypeArgument);</span><br><span class=line>        &#125;</span><br><span class=line>    &#125;</span><br><span class=line>    <span class=comment>/**</span></span><br><span class=line><span class=comment>     * class java.lang.String</span></span><br><span class=line><span class=comment>     * class ren.guard.reflection.User</span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line>&#125;</span><br></pre></td></tr></table></figure><hr><h3 id=反射操作注解><a href=#反射操作注解 class=headerlink title=反射操作注解></a>反射操作注解</h3><ul><li>getAnnotations</li><li>getAnnotation</li></ul><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br><span class=line>81</span><br><span class=line>82</span><br><span class=line>83</span><br><span class=line>84</span><br><span class=line>85</span><br><span class=line>86</span><br><span class=line>87</span><br><span class=line>88</span><br><span class=line>89</span><br><span class=line>90</span><br><span class=line>91</span><br><span class=line>92</span><br><span class=line>93</span><br><span class=line>94</span><br></pre></td><td class=code><pre><span class=line><span class=comment>//反射操作注解</span></span><br><span class=line><span class=keyword>public</span> <span class=class><span class=keyword>class</span> <span class=title>Test12</span> </span>&#123;</span><br><span class=line>    <span class=function><span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class=title>main</span><span class=params>(String[] args)</span> <span class=keyword>throws</span> ClassNotFoundException, NoSuchFieldException </span>&#123;</span><br><span class=line>        Class c1 = Class.forName(<span class=string>"ren.guard.reflection.Student2"</span>);</span><br><span class=line></span><br><span class=line>        <span class=comment>//通过反射获得注解</span></span><br><span class=line>        Annotation[] annotations = c1.getAnnotations();</span><br><span class=line>        <span class=keyword>for</span> (Annotation annotation : annotations) &#123;</span><br><span class=line>            System.out.println(annotation);</span><br><span class=line>        &#125;</span><br><span class=line></span><br><span class=line>        <span class=comment>//获得注解的value的值</span></span><br><span class=line>        TableStudent tableStudent = (TableStudent) c1.getAnnotation(TableStudent<span class=class>.<span class=keyword>class</span>)</span>;</span><br><span class=line>        String value = tableStudent.value();</span><br><span class=line>        System.out.println(value);</span><br><span class=line></span><br><span class=line>        <span class=comment>//获得类指定的注解</span></span><br><span class=line>        Field name = c1.getDeclaredField(<span class=string>"name"</span>);</span><br><span class=line>        FieldStudent fieldStudent = name.getAnnotation(FieldStudent<span class=class>.<span class=keyword>class</span>)</span>;</span><br><span class=line>        System.out.println(fieldStudent.columnName());</span><br><span class=line>        System.out.println(fieldStudent.type());</span><br><span class=line>        System.out.println(fieldStudent.length());</span><br><span class=line>    &#125;</span><br><span class=line>&#125;</span><br><span class=line></span><br><span class=line><span class=meta>@TableStudent</span>(<span class=string>"db_student"</span>)</span><br><span class=line><span class=class><span class=keyword>class</span> <span class=title>Student2</span> </span>&#123;</span><br><span class=line>    <span class=meta>@FieldStudent</span>(columnName = <span class=string>"db_id"</span>, type = <span class=string>"int"</span>, length = <span class=number>10</span>)</span><br><span class=line>    <span class=keyword>private</span> <span class=keyword>int</span> id;</span><br><span class=line>    <span class=meta>@FieldStudent</span>(columnName = <span class=string>"db_name"</span>, type = <span class=string>"varchar"</span>, length = <span class=number>10</span>)</span><br><span class=line>    <span class=keyword>private</span> String name;</span><br><span class=line>    <span class=meta>@FieldStudent</span>(columnName = <span class=string>"db_age"</span>, type = <span class=string>"int"</span>, length = <span class=number>10</span>)</span><br><span class=line>    <span class=keyword>private</span> <span class=keyword>int</span> age;</span><br><span class=line></span><br><span class=line>    <span class=function><span class=keyword>public</span> <span class=title>Student2</span><span class=params>()</span> </span>&#123;</span><br><span class=line>    &#125;</span><br><span class=line></span><br><span class=line>    <span class=function><span class=keyword>public</span> <span class=title>Student2</span><span class=params>(<span class=keyword>int</span> id, String name, <span class=keyword>int</span> age)</span> </span>&#123;</span><br><span class=line>        <span class=keyword>this</span>.id = id;</span><br><span class=line>        <span class=keyword>this</span>.name = name;</span><br><span class=line>        <span class=keyword>this</span>.age = age;</span><br><span class=line>    &#125;</span><br><span class=line></span><br><span class=line>    <span class=function><span class=keyword>public</span> <span class=keyword>int</span> <span class=title>getId</span><span class=params>()</span> </span>&#123;</span><br><span class=line>        <span class=keyword>return</span> id;</span><br><span class=line>    &#125;</span><br><span class=line></span><br><span class=line>    <span class=function><span class=keyword>public</span> <span class=keyword>void</span> <span class=title>setId</span><span class=params>(<span class=keyword>int</span> id)</span> </span>&#123;</span><br><span class=line>        <span class=keyword>this</span>.id = id;</span><br><span class=line>    &#125;</span><br><span class=line></span><br><span class=line>    <span class=function><span class=keyword>public</span> String <span class=title>getName</span><span class=params>()</span> </span>&#123;</span><br><span class=line>        <span class=keyword>return</span> name;</span><br><span class=line>    &#125;</span><br><span class=line></span><br><span class=line>    <span class=function><span class=keyword>public</span> <span class=keyword>void</span> <span class=title>setName</span><span class=params>(String name)</span> </span>&#123;</span><br><span class=line>        <span class=keyword>this</span>.name = name;</span><br><span class=line>    &#125;</span><br><span class=line></span><br><span class=line>    <span class=function><span class=keyword>public</span> <span class=keyword>int</span> <span class=title>getAge</span><span class=params>()</span> </span>&#123;</span><br><span class=line>        <span class=keyword>return</span> age;</span><br><span class=line>    &#125;</span><br><span class=line></span><br><span class=line>    <span class=function><span class=keyword>public</span> <span class=keyword>void</span> <span class=title>setAge</span><span class=params>(<span class=keyword>int</span> age)</span> </span>&#123;</span><br><span class=line>        <span class=keyword>this</span>.age = age;</span><br><span class=line>    &#125;</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=function><span class=keyword>public</span> String <span class=title>toString</span><span class=params>()</span> </span>&#123;</span><br><span class=line>        <span class=keyword>return</span> <span class=string>"Student2&#123;"</span> +</span><br><span class=line>                <span class=string>"id="</span> + id +</span><br><span class=line>                <span class=string>", name='"</span> + name + <span class=string>'\''</span> +</span><br><span class=line>                <span class=string>", age="</span> + age +</span><br><span class=line>                <span class=string>'&#125;'</span>;</span><br><span class=line>    &#125;</span><br><span class=line>&#125;</span><br><span class=line></span><br><span class=line><span class=comment>//类名的注解</span></span><br><span class=line><span class=meta>@Target</span>(ElementType.TYPE)</span><br><span class=line><span class=meta>@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class=line><span class=meta>@interface</span> TableStudent &#123;</span><br><span class=line>    <span class=function>String <span class=title>value</span><span class=params>()</span></span>;</span><br><span class=line>&#125;</span><br><span class=line></span><br><span class=line><span class=comment>//属性的注解</span></span><br><span class=line><span class=meta>@Target</span>(ElementType.FIELD)</span><br><span class=line><span class=meta>@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class=line><span class=meta>@interface</span> FieldStudent &#123;</span><br><span class=line>    <span class=function>String <span class=title>columnName</span><span class=params>()</span></span>;</span><br><span class=line></span><br><span class=line>    <span class=function>String <span class=title>type</span><span class=params>()</span></span>;</span><br><span class=line></span><br><span class=line>    <span class=function><span class=keyword>int</span> <span class=title>length</span><span class=params>()</span></span>;</span><br><span class=line>&#125;</span><br></pre></td></tr></table></figure><hr></div><div><ul class=post-copyright><li class=post-copyright-author><strong>本文作者：</strong>何年何月何时多</li><li class=post-copyright-link><strong>本文链接：</strong> <a href="https://blog.guard.ren/2020/c882d3b8/" title=Java注解和反射>https://blog.guard.ren/2020/c882d3b8/</a></li><li class=post-copyright-license><strong>版权声明：</strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel=noopener target=_blank><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><footer class=post-footer><div class=post-nav><div class=post-nav-item><a href="/2020/7273cdc/" rel=prev title=Maven><i class="fa fa-chevron-left"></i> Maven</a></div><div class=post-nav-item><a href="/2020/5729df21/" rel=next title=多线程>多线程 <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div></div><div class=comments id=valine-comments></div><script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div><aside class=sidebar><div class=sidebar-inner><ul class="sidebar-nav motion-element"><li class=sidebar-nav-toc>文章目录</li><li class=sidebar-nav-overview>站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class=nav><li class="nav-item nav-level-1"><a class=nav-link href=#什么是注解><span class=nav-number>1.</span> <span class=nav-text>什么是注解</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a class=nav-link href=#内置注解><span class=nav-number>1.1.</span> <span class=nav-text>内置注解</span></a></li><li class="nav-item nav-level-2"><a class=nav-link href=#元注解><span class=nav-number>1.2.</span> <span class=nav-text>元注解</span></a></li><li class="nav-item nav-level-2"><a class=nav-link href=#自定义注解><span class=nav-number>1.3.</span> <span class=nav-text>自定义注解</span></a></li></ol></li><li class="nav-item nav-level-1"><a class=nav-link href=#反射机制><span class=nav-number>2.</span> <span class=nav-text>反射机制</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a class=nav-link href=#Java-反射机制概述><span class=nav-number>2.1.</span> <span class=nav-text>Java 反射机制概述</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#静态语言与动态语言><span class=nav-number>2.1.1.</span> <span class=nav-text>静态语言与动态语言</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#动态语言><span class=nav-number>2.1.1.1.</span> <span class=nav-text>动态语言</span></a></li><li class="nav-item nav-level-4"><a class=nav-link href=#静态语言><span class=nav-number>2.1.1.2.</span> <span class=nav-text>静态语言</span></a></li></ol></li><li class="nav-item nav-level-3"><a class=nav-link href=#Java-Reflection><span class=nav-number>2.1.2.</span> <span class=nav-text>Java Reflection</span></a></li><li class="nav-item nav-level-3"><a class=nav-link href=#Java-反射机制提供的功能><span class=nav-number>2.1.3.</span> <span class=nav-text>Java 反射机制提供的功能</span></a></li><li class="nav-item nav-level-3"><a class=nav-link href=#Java-反射优点和缺点><span class=nav-number>2.1.4.</span> <span class=nav-text>Java 反射优点和缺点</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#优点：><span class=nav-number>2.1.4.1.</span> <span class=nav-text>优点：</span></a></li><li class="nav-item nav-level-4"><a class=nav-link href=#缺点：><span class=nav-number>2.1.4.2.</span> <span class=nav-text>缺点：</span></a></li></ol></li><li class="nav-item nav-level-3"><a class=nav-link href=#反射相关的主要-API><span class=nav-number>2.1.5.</span> <span class=nav-text>反射相关的主要 API</span></a></li></ol></li><li class="nav-item nav-level-2"><a class=nav-link href=#理解-Class-类并获取-Class><span class=nav-number>2.2.</span> <span class=nav-text>理解 Class 类并获取 Class</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#Class-类><span class=nav-number>2.2.1.</span> <span class=nav-text>Class 类</span></a></li><li class="nav-item nav-level-3"><a class=nav-link href=#Class-类的常用方法><span class=nav-number>2.2.2.</span> <span class=nav-text>Class 类的常用方法</span></a></li><li class="nav-item nav-level-3"><a class=nav-link href=#获取-Class-类的实例><span class=nav-number>2.2.3.</span> <span class=nav-text>获取 Class 类的实例</span></a></li><li class="nav-item nav-level-3"><a class=nav-link href=#那些类型可以有-Class-对象><span class=nav-number>2.2.4.</span> <span class=nav-text>那些类型可以有 Class 对象</span></a></li></ol></li><li class="nav-item nav-level-2"><a class=nav-link href=#类的加载与-ClassLoader><span class=nav-number>2.3.</span> <span class=nav-text>类的加载与 ClassLoader</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#Java-内存分析><span class=nav-number>2.3.1.</span> <span class=nav-text>Java 内存分析</span></a></li></ol></li><li class="nav-item nav-level-2"><a class=nav-link href=#><span class=nav-number>2.4.</span> <span class=nav-text></span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#类的加载过程><span class=nav-number>2.4.1.</span> <span class=nav-text>类的加载过程</span></a></li><li class="nav-item nav-level-3"><a class=nav-link href=#什么时候会发生类初始化><span class=nav-number>2.4.2.</span> <span class=nav-text>什么时候会发生类初始化</span></a></li><li class="nav-item nav-level-3"><a class=nav-link href=#类加载器的作用><span class=nav-number>2.4.3.</span> <span class=nav-text>类加载器的作用</span></a></li></ol></li><li class="nav-item nav-level-2"><a class=nav-link href=#获取运行时类的完整结构><span class=nav-number>2.5.</span> <span class=nav-text>获取运行时类的完整结构</span></a></li><li class="nav-item nav-level-2"><a class=nav-link href=#反射><span class=nav-number>2.6.</span> <span class=nav-text>反射</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#创建对象><span class=nav-number>2.6.1.</span> <span class=nav-text>创建对象</span></a></li><li class="nav-item nav-level-3"><a class=nav-link href=#调用指定的方法><span class=nav-number>2.6.2.</span> <span class=nav-text>调用指定的方法</span></a></li><li class="nav-item nav-level-3"><a class=nav-link href=#反射性能测试><span class=nav-number>2.6.3.</span> <span class=nav-text>反射性能测试</span></a></li><li class="nav-item nav-level-3"><a class=nav-link href=#反射操作泛型><span class=nav-number>2.6.4.</span> <span class=nav-text>反射操作泛型</span></a></li><li class="nav-item nav-level-3"><a class=nav-link href=#反射操作注解><span class=nav-number>2.6.5.</span> <span class=nav-text>反射操作注解</span></a></li></ol></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=何年何月何时多 src="https://q1.qlogo.cn/g?b=qq&nk=770600073&s=5"><p class=site-author-name itemprop=name>何年何月何时多</p><div class=site-description itemprop=description>我的身旁是一扇亮了又暗的窗</div></div><div class="site-state-wrap motion-element"><nav class=site-state><div class="site-state-item site-state-posts"><a href="/archives/"><span class=site-state-item-count>6</span> <span class=site-state-item-name>日志</span></a></div></nav></div><div class="links-of-author motion-element"><span class=links-of-author-item><a href=https://github.com/isGuard title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;isGuard" rel=noopener target=_blank><i class="fa fa-fw fa-github"></i>GitHub</a></span> <span class=links-of-author-item><a href=mailto:isguard@outlook.com title="E-Mail → mailto:isguard@outlook.com" rel=noopener target=_blank><i class="fa fa-fw fa-envelope"></i>E-Mail</a></span></div><div class="cc-license motion-element" itemprop=license><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class=cc-opacity rel=noopener target=_blank><img src=/images/cc-by-nc-sa.svg alt="Creative Commons"></a></div><div class="links-of-blogroll motion-element"><div class=links-of-blogroll-title><i class="fa fa-fw fa-link"></i> 友链</div><ul class=links-of-blogroll-list><li class=links-of-blogroll-item><a href="https://www.lostdeer.cn/" title=https:&#x2F;&#x2F;www.lostdeer.cn rel=noopener target=_blank>LostDeer</a></li></ul></div></div></div></aside><div id=sidebar-dimmer></div></div></main><footer class=footer><div class=footer-inner><div class=copyright>&copy; 2019 – <span itemprop=copyrightYear>2020</span> <span class=with-love><i class="fa fa-heart"></i></span> <span class=author itemprop=copyrightHolder>何年何月何时多</span> <span class=post-meta-divider>|</span> <span class=post-meta-item-icon><i class="fa fa-area-chart"></i></span> <span class=post-meta-item-text>站点总字数：</span> <span title=站点总字数>51k</span> <span class=post-meta-divider>|</span> <span class=post-meta-item-icon><i class="fa fa-coffee"></i></span> <span class=post-meta-item-text>站点阅读时长 &asymp;</span> <span title=站点阅读时长>46 分钟</span></div><div class=addthis_inline_share_toolbox><script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5c9a39fa0e8d042b" async></script></div><div style="display: none;"><script pjax src="//s95.cnzz.com/z_stat.php?id=1261517279&web_id=1261517279"></script></div></div></footer></div><script src=/lib/anime.min.js></script><script src=//cdn.jsdelivr.net/gh/theme-next/theme-next-pjax@0/pjax.min.js></script><script src=//cdn.jsdelivr.net/npm/medium-zoom@1/dist/medium-zoom.min.js></script><script src=//cdnjs.cloudflare.com/ajax/libs/lozad.js/1.14.0/lozad.min.js></script><script src=//cdn.jsdelivr.net/npm/pangu@4/dist/browser/pangu.min.js></script><script src=//cdn.jsdelivr.net/npm/velocity-animate@1/velocity.min.js></script><script src=//cdn.jsdelivr.net/npm/velocity-animate@1/velocity.ui.min.js></script><script src=/js/utils.js></script><script src=/js/motion.js></script><script src=/js/schemes/muse.js></script><script src=/js/next-boot.js></script><script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '#pjax'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
  document.querySelectorAll('script[pjax], script#page-configurations, #pjax script').forEach(element => {
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (element.id) {
      script.id = element.id;
    }
    if (element.className) {
      script.className = element.className;
    }
    if (element.type) {
      script.type = element.type;
    }
    if (element.src) {
      script.src = element.src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (element.getAttribute('pjax') !== null) {
      script.setAttribute('pjax', '');
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  NexT.utils.updateSidebarPosition();
});
</script><script defer src=//cdn.jsdelivr.net/gh/theme-next/theme-next-three@1/three.min.js></script><script pjax>
    (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      bp.src = (curProtocol === 'https') ? 'https://zz.bdstatic.com/linksubmit/push.js' : 'http://push.zhanzhang.baidu.com/push.js';
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script><script src=/js/local-search.js></script><div id=pjax><script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/valine@1/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : true,
      appId      : 'C9AAW8SB4K7bNBlRqfu6rywU-gzGzoHsz',
      appKey     : 'ChKeqxyh2HFkQT23TV4lEEWE',
      placeholder: "ヾﾉ≧∀≦)o 来呀！快活啊！",
      avatar     : 'robohash',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : true,
      lang       : 'zh-cn' || 'zh-cn',
      path       : location.pathname,
      recordIP   : true,
      serverURLs : ''
    });
  }, window.Valine);
});
</script><script type=text/javascript>
if(document.getElementById('guard')){
    var head= document.getElementsByTagName('head')[0];
    var script= document.createElement('script');
    script.src= 'https://v1.hitokoto.cn/?encode=js&select=%23guard';
    head.appendChild(script);
}
</script></div><script src=/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body></html>